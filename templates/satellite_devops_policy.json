{
    "Version": "2012-10-17",
    "Statement": [
        {
            "Sid": "AllowS3Replication",
            "Effect": "Allow",
            "Action": [
                "s3:PutReplicationConfiguration"
            ],
            "Resource": ["arn:aws:s3:::tecton-${DEPLOYMENT_NAME}"]
        },
        {
            "Sid": "AllowCreateS3ReplicationRole",
            "Effect": "Allow",
            "Action": [
                "iam:CreateRole"
            ],
            "Resource": [
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-bucket-replication-tecton-${DEPLOYMENT_NAME}",
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-batch-operation-tecton-${DEPLOYMENT_NAME}"
            ]
        },
        {
            "Sid": "AllowAttachS3ReplicationPolicy",
            "Effect": "Allow",
            "Action": [
                "iam:AttachRolePolicy"
            ],
            "Resource": [
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-bucket-replication-tecton-${DEPLOYMENT_NAME}",
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-batch-operation-tecton-${DEPLOYMENT_NAME}"
            ],
            "Condition": {
                "StringEquals": {
                    "iam:PolicyARN": ${SATELLITE_REPLICATION_POLICY}
                }
            }
        },
        {
            "Sid": "ManangeS3ReplicationRole",
            "Effect": "Allow",
            "Action": [
                "iam:PassRole"
            ],
            "Resource": [
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-bucket-replication-tecton-${DEPLOYMENT_NAME}",
                "arn:aws:iam::${ACCOUNT_ID}:role/tecton-s3-batch-operation-tecton-${DEPLOYMENT_NAME}"
            ]
        },
        {
            "Sid": "ManageSecurityGroups",
            "Effect": "Allow",
            "Action": [
                "ec2:AuthorizeSecurityGroupEgress",
                "ec2:AuthorizeSecurityGroupIngress",
                "ec2:RevokeSecurityGroupEgress",
                "ec2:CreateSecurityGroup",
                "ec2:CreateTags",
                "ec2:DeleteSecurityGroup",
                "ec2:RevokeSecurityGroupIngress"
            ],
            "Resource": ${SECURITY_GROUPS}
        }
    ]
}
